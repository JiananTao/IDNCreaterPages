{"version":3,"file":"js/245.29e61691.js","mappings":"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","sources":["webpack://IDNCreaterPages/../src/dagre-wrapper/markers.js","webpack://IDNCreaterPages/../src/dagre-wrapper/createLabel.js","webpack://IDNCreaterPages/../src/dagre-wrapper/shapes/util.js","webpack://IDNCreaterPages/../src/dagre-wrapper/intersect/intersect-node.js","webpack://IDNCreaterPages/../src/dagre-wrapper/intersect/intersect-ellipse.js","webpack://IDNCreaterPages/../src/dagre-wrapper/intersect/intersect-circle.js","webpack://IDNCreaterPages/../src/dagre-wrapper/intersect/intersect-line.js","webpack://IDNCreaterPages/../src/dagre-wrapper/intersect/intersect-polygon.js","webpack://IDNCreaterPages/../src/dagre-wrapper/intersect/intersect-rect.js","webpack://IDNCreaterPages/../src/dagre-wrapper/intersect/index.js","webpack://IDNCreaterPages/../src/dagre-wrapper/shapes/note.js","webpack://IDNCreaterPages/../src/dagre-wrapper/nodes.js","webpack://IDNCreaterPages/../src/dagre-wrapper/edges.js","webpack://IDNCreaterPages/../src/diagrams/class/svgDraw.js"],"sourcesContent":["/** Setup arrow head and define the marker. The result is appended to the svg. */\n\nimport { log } from '../logger';\n\n// Only add the number of markers that the diagram needs\nconst insertMarkers = (elem, markerArray, type, id) => {\n  markerArray.forEach((markerName) => {\n    markers[markerName](elem, type, id);\n  });\n};\n\nconst extension = (elem, type, id) => {\n  log.trace('Making markers for ', id);\n  elem\n    .append('defs')\n    .append('marker')\n    .attr('id', type + '-extensionStart')\n    .attr('class', 'marker extension ' + type)\n    .attr('refX', 0)\n    .attr('refY', 7)\n    .attr('markerWidth', 190)\n    .attr('markerHeight', 240)\n    .attr('orient', 'auto')\n    .append('path')\n    .attr('d', 'M 1,7 L18,13 V 1 Z');\n\n  elem\n    .append('defs')\n    .append('marker')\n    .attr('id', type + '-extensionEnd')\n    .attr('class', 'marker extension ' + type)\n    .attr('refX', 19)\n    .attr('refY', 7)\n    .attr('markerWidth', 20)\n    .attr('markerHeight', 28)\n    .attr('orient', 'auto')\n    .append('path')\n    .attr('d', 'M 1,1 V 13 L18,7 Z'); // this is actual shape for arrowhead\n};\n\nconst composition = (elem, type) => {\n  elem\n    .append('defs')\n    .append('marker')\n    .attr('id', type + '-compositionStart')\n    .attr('class', 'marker composition ' + type)\n    .attr('refX', 0)\n    .attr('refY', 7)\n    .attr('markerWidth', 190)\n    .attr('markerHeight', 240)\n    .attr('orient', 'auto')\n    .append('path')\n    .attr('d', 'M 18,7 L9,13 L1,7 L9,1 Z');\n\n  elem\n    .append('defs')\n    .append('marker')\n    .attr('id', type + '-compositionEnd')\n    .attr('class', 'marker composition ' + type)\n    .attr('refX', 19)\n    .attr('refY', 7)\n    .attr('markerWidth', 20)\n    .attr('markerHeight', 28)\n    .attr('orient', 'auto')\n    .append('path')\n    .attr('d', 'M 18,7 L9,13 L1,7 L9,1 Z');\n};\nconst aggregation = (elem, type) => {\n  elem\n    .append('defs')\n    .append('marker')\n    .attr('id', type + '-aggregationStart')\n    .attr('class', 'marker aggregation ' + type)\n    .attr('refX', 0)\n    .attr('refY', 7)\n    .attr('markerWidth', 190)\n    .attr('markerHeight', 240)\n    .attr('orient', 'auto')\n    .append('path')\n    .attr('d', 'M 18,7 L9,13 L1,7 L9,1 Z');\n\n  elem\n    .append('defs')\n    .append('marker')\n    .attr('id', type + '-aggregationEnd')\n    .attr('class', 'marker aggregation ' + type)\n    .attr('refX', 19)\n    .attr('refY', 7)\n    .attr('markerWidth', 20)\n    .attr('markerHeight', 28)\n    .attr('orient', 'auto')\n    .append('path')\n    .attr('d', 'M 18,7 L9,13 L1,7 L9,1 Z');\n};\nconst dependency = (elem, type) => {\n  elem\n    .append('defs')\n    .append('marker')\n    .attr('id', type + '-dependencyStart')\n    .attr('class', 'marker dependency ' + type)\n    .attr('refX', 0)\n    .attr('refY', 7)\n    .attr('markerWidth', 190)\n    .attr('markerHeight', 240)\n    .attr('orient', 'auto')\n    .append('path')\n    .attr('d', 'M 5,7 L9,13 L1,7 L9,1 Z');\n\n  elem\n    .append('defs')\n    .append('marker')\n    .attr('id', type + '-dependencyEnd')\n    .attr('class', 'marker dependency ' + type)\n    .attr('refX', 19)\n    .attr('refY', 7)\n    .attr('markerWidth', 20)\n    .attr('markerHeight', 28)\n    .attr('orient', 'auto')\n    .append('path')\n    .attr('d', 'M 18,7 L9,13 L14,7 L9,1 Z');\n};\nconst lollipop = (elem, type) => {\n  elem\n    .append('defs')\n    .append('marker')\n    .attr('id', type + '-lollipopStart')\n    .attr('class', 'marker lollipop ' + type)\n    .attr('refX', 0)\n    .attr('refY', 7)\n    .attr('markerWidth', 190)\n    .attr('markerHeight', 240)\n    .attr('orient', 'auto')\n    .append('circle')\n    .attr('stroke', 'black')\n    .attr('fill', 'white')\n    .attr('cx', 6)\n    .attr('cy', 7)\n    .attr('r', 6);\n};\nconst point = (elem, type) => {\n  elem\n    .append('marker')\n    .attr('id', type + '-pointEnd')\n    .attr('class', 'marker ' + type)\n    .attr('viewBox', '0 0 12 20')\n    .attr('refX', 10)\n    .attr('refY', 5)\n    .attr('markerUnits', 'userSpaceOnUse')\n    .attr('markerWidth', 12)\n    .attr('markerHeight', 12)\n    .attr('orient', 'auto')\n    .append('path')\n    .attr('d', 'M 0 0 L 10 5 L 0 10 z')\n    .attr('class', 'arrowMarkerPath')\n    .style('stroke-width', 1)\n    .style('stroke-dasharray', '1,0');\n  elem\n    .append('marker')\n    .attr('id', type + '-pointStart')\n    .attr('class', 'marker ' + type)\n    .attr('viewBox', '0 0 10 10')\n    .attr('refX', 0)\n    .attr('refY', 5)\n    .attr('markerUnits', 'userSpaceOnUse')\n    .attr('markerWidth', 12)\n    .attr('markerHeight', 12)\n    .attr('orient', 'auto')\n    .append('path')\n    .attr('d', 'M 0 5 L 10 10 L 10 0 z')\n    .attr('class', 'arrowMarkerPath')\n    .style('stroke-width', 1)\n    .style('stroke-dasharray', '1,0');\n};\nconst circle = (elem, type) => {\n  elem\n    .append('marker')\n    .attr('id', type + '-circleEnd')\n    .attr('class', 'marker ' + type)\n    .attr('viewBox', '0 0 10 10')\n    .attr('refX', 11)\n    .attr('refY', 5)\n    .attr('markerUnits', 'userSpaceOnUse')\n    .attr('markerWidth', 11)\n    .attr('markerHeight', 11)\n    .attr('orient', 'auto')\n    .append('circle')\n    .attr('cx', '5')\n    .attr('cy', '5')\n    .attr('r', '5')\n    .attr('class', 'arrowMarkerPath')\n    .style('stroke-width', 1)\n    .style('stroke-dasharray', '1,0');\n\n  elem\n    .append('marker')\n    .attr('id', type + '-circleStart')\n    .attr('class', 'marker ' + type)\n    .attr('viewBox', '0 0 10 10')\n    .attr('refX', -1)\n    .attr('refY', 5)\n    .attr('markerUnits', 'userSpaceOnUse')\n    .attr('markerWidth', 11)\n    .attr('markerHeight', 11)\n    .attr('orient', 'auto')\n    .append('circle')\n    .attr('cx', '5')\n    .attr('cy', '5')\n    .attr('r', '5')\n    .attr('class', 'arrowMarkerPath')\n    .style('stroke-width', 1)\n    .style('stroke-dasharray', '1,0');\n};\nconst cross = (elem, type) => {\n  elem\n    .append('marker')\n    .attr('id', type + '-crossEnd')\n    .attr('class', 'marker cross ' + type)\n    .attr('viewBox', '0 0 11 11')\n    .attr('refX', 12)\n    .attr('refY', 5.2)\n    .attr('markerUnits', 'userSpaceOnUse')\n    .attr('markerWidth', 11)\n    .attr('markerHeight', 11)\n    .attr('orient', 'auto')\n    .append('path')\n    // .attr('stroke', 'black')\n    .attr('d', 'M 1,1 l 9,9 M 10,1 l -9,9')\n    .attr('class', 'arrowMarkerPath')\n    .style('stroke-width', 2)\n    .style('stroke-dasharray', '1,0');\n\n  elem\n    .append('marker')\n    .attr('id', type + '-crossStart')\n    .attr('class', 'marker cross ' + type)\n    .attr('viewBox', '0 0 11 11')\n    .attr('refX', -1)\n    .attr('refY', 5.2)\n    .attr('markerUnits', 'userSpaceOnUse')\n    .attr('markerWidth', 11)\n    .attr('markerHeight', 11)\n    .attr('orient', 'auto')\n    .append('path')\n    // .attr('stroke', 'black')\n    .attr('d', 'M 1,1 l 9,9 M 10,1 l -9,9')\n    .attr('class', 'arrowMarkerPath')\n    .style('stroke-width', 2)\n    .style('stroke-dasharray', '1,0');\n};\nconst barb = (elem, type) => {\n  elem\n    .append('defs')\n    .append('marker')\n    .attr('id', type + '-barbEnd')\n    .attr('refX', 19)\n    .attr('refY', 7)\n    .attr('markerWidth', 20)\n    .attr('markerHeight', 14)\n    .attr('markerUnits', 'strokeWidth')\n    .attr('orient', 'auto')\n    .append('path')\n    .attr('d', 'M 19,7 L9,13 L14,7 L9,1 Z');\n};\n\n// TODO rename the class diagram markers to something shape descriptive and semantic free\nconst markers = {\n  extension,\n  composition,\n  aggregation,\n  dependency,\n  lollipop,\n  point,\n  circle,\n  cross,\n  barb,\n};\nexport default insertMarkers;\n","import { select } from 'd3';\nimport { log } from '../logger';\nimport { getConfig } from '../config';\nimport { evaluate } from '../diagrams/common/common';\nimport { decodeEntities } from '../mermaidAPI';\n\n/**\n * @param dom\n * @param styleFn\n */\nfunction applyStyle(dom, styleFn) {\n  if (styleFn) {\n    dom.attr('style', styleFn);\n  }\n}\n\n/**\n * @param {any} node\n * @returns {SVGForeignObjectElement} Node\n */\nfunction addHtmlLabel(node) {\n  const fo = select(document.createElementNS('http://www.w3.org/2000/svg', 'foreignObject'));\n  const div = fo.append('xhtml:div');\n\n  const label = node.label;\n  const labelClass = node.isNode ? 'nodeLabel' : 'edgeLabel';\n  div.html(\n    '<span class=\"' +\n      labelClass +\n      '\" ' +\n      (node.labelStyle ? 'style=\"' + node.labelStyle + '\"' : '') +\n      '>' +\n      label +\n      '</span>'\n  );\n\n  applyStyle(div, node.labelStyle);\n  div.style('display', 'inline-block');\n  // Fix for firefox\n  div.style('white-space', 'nowrap');\n  div.attr('xmlns', 'http://www.w3.org/1999/xhtml');\n  return fo.node();\n}\n/**\n * @param _vertexText\n * @param style\n * @param isTitle\n * @param isNode\n * @deprecated svg-util/createText instead\n */\nconst createLabel = (_vertexText, style, isTitle, isNode) => {\n  let vertexText = _vertexText || '';\n  if (typeof vertexText === 'object') {\n    vertexText = vertexText[0];\n  }\n  if (evaluate(getConfig().flowchart.htmlLabels)) {\n    // TODO: addHtmlLabel accepts a labelStyle. Do we possibly have that?\n    vertexText = vertexText.replace(/\\\\n|\\n/g, '<br />');\n    log.info('vertexText' + vertexText);\n    const node = {\n      isNode,\n      label: decodeEntities(vertexText).replace(\n        /fa[blrs]?:fa-[\\w-]+/g,\n        (s) => `<i class='${s.replace(':', ' ')}'></i>`\n      ),\n      labelStyle: style.replace('fill:', 'color:'),\n    };\n    let vertexNode = addHtmlLabel(node);\n    // vertexNode.parentNode.removeChild(vertexNode);\n    return vertexNode;\n  } else {\n    const svgLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n    svgLabel.setAttribute('style', style.replace('color:', 'fill:'));\n    let rows = [];\n    if (typeof vertexText === 'string') {\n      rows = vertexText.split(/\\\\n|\\n|<br\\s*\\/?>/gi);\n    } else if (Array.isArray(vertexText)) {\n      rows = vertexText;\n    } else {\n      rows = [];\n    }\n\n    for (const row of rows) {\n      const tspan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');\n      tspan.setAttributeNS('http://www.w3.org/XML/1998/namespace', 'xml:space', 'preserve');\n      tspan.setAttribute('dy', '1em');\n      tspan.setAttribute('x', '0');\n      if (isTitle) {\n        tspan.setAttribute('class', 'title-row');\n      } else {\n        tspan.setAttribute('class', 'row');\n      }\n      tspan.textContent = row.trim();\n      svgLabel.appendChild(tspan);\n    }\n    return svgLabel;\n  }\n};\n\nexport default createLabel;\n","import createLabel from '../createLabel';\nimport { createText } from '../../rendering-util/createText';\nimport { getConfig } from '../../config';\nimport { decodeEntities } from '../../mermaidAPI';\nimport { select } from 'd3';\nimport { evaluate, sanitizeText } from '../../diagrams/common/common';\nexport const labelHelper = (parent, node, _classes, isNode) => {\n  let classes;\n  const useHtmlLabels = node.useHtmlLabels || evaluate(getConfig().flowchart.htmlLabels);\n  if (!_classes) {\n    classes = 'node default';\n  } else {\n    classes = _classes;\n  }\n  // Add outer g element\n  const shapeSvg = parent\n    .insert('g')\n    .attr('class', classes)\n    .attr('id', node.domId || node.id);\n\n  // Create the label and insert it after the rect\n  const label = shapeSvg.insert('g').attr('class', 'label').attr('style', node.labelStyle);\n\n  // Replace labelText with default value if undefined\n  let labelText;\n  if (node.labelText === undefined) {\n    labelText = '';\n  } else {\n    labelText = typeof node.labelText === 'string' ? node.labelText : node.labelText[0];\n  }\n\n  const textNode = label.node();\n  let text;\n  if (node.labelType === 'markdown') {\n    // text = textNode;\n    text = createText(label, sanitizeText(decodeEntities(labelText), getConfig()), {\n      useHtmlLabels,\n      width: node.width || getConfig().flowchart.wrappingWidth,\n      classes: 'markdown-node-label',\n    });\n  } else {\n    text = textNode.appendChild(\n      createLabel(\n        sanitizeText(decodeEntities(labelText), getConfig()),\n        node.labelStyle,\n        false,\n        isNode\n      )\n    );\n  }\n\n  // Get the size of the label\n  let bbox = text.getBBox();\n\n  if (evaluate(getConfig().flowchart.htmlLabels)) {\n    const div = text.children[0];\n    const dv = select(text);\n    bbox = div.getBoundingClientRect();\n    dv.attr('width', bbox.width);\n    dv.attr('height', bbox.height);\n  }\n\n  const halfPadding = node.padding / 2;\n\n  // Center the label\n  if (useHtmlLabels) {\n    label.attr('transform', 'translate(' + -bbox.width / 2 + ', ' + -bbox.height / 2 + ')');\n  } else {\n    label.attr('transform', 'translate(' + 0 + ', ' + -bbox.height / 2 + ')');\n  }\n  if (node.centerLabel) {\n    label.attr('transform', 'translate(' + -bbox.width / 2 + ', ' + -bbox.height / 2 + ')');\n  }\n  label.insert('rect', ':first-child');\n  return { shapeSvg, bbox, halfPadding, label };\n};\n\nexport const updateNodeBounds = (node, element) => {\n  const bbox = element.node().getBBox();\n  node.width = bbox.width;\n  node.height = bbox.height;\n};\n\n/**\n * @param parent\n * @param w\n * @param h\n * @param points\n */\nexport function insertPolygonShape(parent, w, h, points) {\n  return parent\n    .insert('polygon', ':first-child')\n    .attr(\n      'points',\n      points\n        .map(function (d) {\n          return d.x + ',' + d.y;\n        })\n        .join(' ')\n    )\n    .attr('class', 'label-container')\n    .attr('transform', 'translate(' + -w / 2 + ',' + h / 2 + ')');\n}\n","/**\n * @param node\n * @param point\n */\nfunction intersectNode(node, point) {\n  // console.info('Intersect Node');\n  return node.intersect(point);\n}\n\nexport default intersectNode;\n","/**\n * @param node\n * @param rx\n * @param ry\n * @param point\n */\nfunction intersectEllipse(node, rx, ry, point) {\n  // Formulae from: https://mathworld.wolfram.com/Ellipse-LineIntersection.html\n\n  var cx = node.x;\n  var cy = node.y;\n\n  var px = cx - point.x;\n  var py = cy - point.y;\n\n  var det = Math.sqrt(rx * rx * py * py + ry * ry * px * px);\n\n  var dx = Math.abs((rx * ry * px) / det);\n  if (point.x < cx) {\n    dx = -dx;\n  }\n  var dy = Math.abs((rx * ry * py) / det);\n  if (point.y < cy) {\n    dy = -dy;\n  }\n\n  return { x: cx + dx, y: cy + dy };\n}\n\nexport default intersectEllipse;\n","import intersectEllipse from './intersect-ellipse';\n\n/**\n * @param node\n * @param rx\n * @param point\n */\nfunction intersectCircle(node, rx, point) {\n  return intersectEllipse(node, rx, rx, point);\n}\n\nexport default intersectCircle;\n","/**\n * Returns the point at which two lines, p and q, intersect or returns undefined if they do not intersect.\n *\n * @param p1\n * @param p2\n * @param q1\n * @param q2\n */\nfunction intersectLine(p1, p2, q1, q2) {\n  // Algorithm from J. Avro, (ed.) Graphics Gems, No 2, Morgan Kaufmann, 1994,\n  // p7 and p473.\n\n  var a1, a2, b1, b2, c1, c2;\n  var r1, r2, r3, r4;\n  var denom, offset, num;\n  var x, y;\n\n  // Compute a1, b1, c1, where line joining points 1 and 2 is F(x,y) = a1 x +\n  // b1 y + c1 = 0.\n  a1 = p2.y - p1.y;\n  b1 = p1.x - p2.x;\n  c1 = p2.x * p1.y - p1.x * p2.y;\n\n  // Compute r3 and r4.\n  r3 = a1 * q1.x + b1 * q1.y + c1;\n  r4 = a1 * q2.x + b1 * q2.y + c1;\n\n  // Check signs of r3 and r4. If both point 3 and point 4 lie on\n  // same side of line 1, the line segments do not intersect.\n  if (r3 !== 0 && r4 !== 0 && sameSign(r3, r4)) {\n    return /*DON'T_INTERSECT*/;\n  }\n\n  // Compute a2, b2, c2 where line joining points 3 and 4 is G(x,y) = a2 x + b2 y + c2 = 0\n  a2 = q2.y - q1.y;\n  b2 = q1.x - q2.x;\n  c2 = q2.x * q1.y - q1.x * q2.y;\n\n  // Compute r1 and r2\n  r1 = a2 * p1.x + b2 * p1.y + c2;\n  r2 = a2 * p2.x + b2 * p2.y + c2;\n\n  // Check signs of r1 and r2. If both point 1 and point 2 lie\n  // on same side of second line segment, the line segments do\n  // not intersect.\n  if (r1 !== 0 && r2 !== 0 && sameSign(r1, r2)) {\n    return /*DON'T_INTERSECT*/;\n  }\n\n  // Line segments intersect: compute intersection point.\n  denom = a1 * b2 - a2 * b1;\n  if (denom === 0) {\n    return /*COLLINEAR*/;\n  }\n\n  offset = Math.abs(denom / 2);\n\n  // The denom/2 is to get rounding instead of truncating. It\n  // is added or subtracted to the numerator, depending upon the\n  // sign of the numerator.\n  num = b1 * c2 - b2 * c1;\n  x = num < 0 ? (num - offset) / denom : (num + offset) / denom;\n\n  num = a2 * c1 - a1 * c2;\n  y = num < 0 ? (num - offset) / denom : (num + offset) / denom;\n\n  return { x: x, y: y };\n}\n\n/**\n * @param r1\n * @param r2\n */\nfunction sameSign(r1, r2) {\n  return r1 * r2 > 0;\n}\n\nexport default intersectLine;\n","/* eslint \"no-console\": off */\n\nimport intersectLine from './intersect-line';\n\nexport default intersectPolygon;\n\n/**\n * Returns the point ({x, y}) at which the point argument intersects with the node argument assuming\n * that it has the shape specified by polygon.\n *\n * @param node\n * @param polyPoints\n * @param point\n */\nfunction intersectPolygon(node, polyPoints, point) {\n  var x1 = node.x;\n  var y1 = node.y;\n\n  var intersections = [];\n\n  var minX = Number.POSITIVE_INFINITY;\n  var minY = Number.POSITIVE_INFINITY;\n  if (typeof polyPoints.forEach === 'function') {\n    polyPoints.forEach(function (entry) {\n      minX = Math.min(minX, entry.x);\n      minY = Math.min(minY, entry.y);\n    });\n  } else {\n    minX = Math.min(minX, polyPoints.x);\n    minY = Math.min(minY, polyPoints.y);\n  }\n\n  var left = x1 - node.width / 2 - minX;\n  var top = y1 - node.height / 2 - minY;\n\n  for (var i = 0; i < polyPoints.length; i++) {\n    var p1 = polyPoints[i];\n    var p2 = polyPoints[i < polyPoints.length - 1 ? i + 1 : 0];\n    var intersect = intersectLine(\n      node,\n      point,\n      { x: left + p1.x, y: top + p1.y },\n      { x: left + p2.x, y: top + p2.y }\n    );\n    if (intersect) {\n      intersections.push(intersect);\n    }\n  }\n\n  if (!intersections.length) {\n    // console.log('NO INTERSECTION FOUND, RETURN NODE CENTER', node);\n    return node;\n  }\n\n  if (intersections.length > 1) {\n    // More intersections, find the one nearest to edge end point\n    intersections.sort(function (p, q) {\n      var pdx = p.x - point.x;\n      var pdy = p.y - point.y;\n      var distp = Math.sqrt(pdx * pdx + pdy * pdy);\n\n      var qdx = q.x - point.x;\n      var qdy = q.y - point.y;\n      var distq = Math.sqrt(qdx * qdx + qdy * qdy);\n\n      return distp < distq ? -1 : distp === distq ? 0 : 1;\n    });\n  }\n  return intersections[0];\n}\n","const intersectRect = (node, point) => {\n  var x = node.x;\n  var y = node.y;\n\n  // Rectangle intersection algorithm from:\n  // https://math.stackexchange.com/questions/108113/find-edge-between-two-boxes\n  var dx = point.x - x;\n  var dy = point.y - y;\n  var w = node.width / 2;\n  var h = node.height / 2;\n\n  var sx, sy;\n  if (Math.abs(dy) * w > Math.abs(dx) * h) {\n    // Intersection is top or bottom of rect.\n    if (dy < 0) {\n      h = -h;\n    }\n    sx = dy === 0 ? 0 : (h * dx) / dy;\n    sy = h;\n  } else {\n    // Intersection is left or right of rect.\n    if (dx < 0) {\n      w = -w;\n    }\n    sx = w;\n    sy = dx === 0 ? 0 : (w * dy) / dx;\n  }\n\n  return { x: x + sx, y: y + sy };\n};\n\nexport default intersectRect;\n","/*\n * Borrowed with love from from dagre-d3. Many thanks to cpettitt!\n */\n\nimport node from './intersect-node.js';\nimport circle from './intersect-circle.js';\nimport ellipse from './intersect-ellipse.js';\nimport polygon from './intersect-polygon.js';\nimport rect from './intersect-rect.js';\n\nexport default {\n  node,\n  circle,\n  ellipse,\n  polygon,\n  rect,\n};\n","import { updateNodeBounds, labelHelper } from './util';\nimport { log } from '../../logger';\nimport { getConfig } from '../../config';\nimport intersect from '../intersect/index.js';\n\nconst note = (parent, node) => {\n  const useHtmlLabels = node.useHtmlLabels || getConfig().flowchart.htmlLabels;\n  if (!useHtmlLabels) {\n    node.centerLabel = true;\n  }\n  const { shapeSvg, bbox, halfPadding } = labelHelper(parent, node, 'node ' + node.classes, true);\n\n  log.info('Classes = ', node.classes);\n  // add the rect\n  const rect = shapeSvg.insert('rect', ':first-child');\n\n  rect\n    .attr('rx', node.rx)\n    .attr('ry', node.ry)\n    .attr('x', -bbox.width / 2 - halfPadding)\n    .attr('y', -bbox.height / 2 - halfPadding)\n    .attr('width', bbox.width + node.padding)\n    .attr('height', bbox.height + node.padding);\n\n  updateNodeBounds(node, rect);\n\n  node.intersect = function (point) {\n    return intersect.rect(node, point);\n  };\n\n  return shapeSvg;\n};\n\nexport default note;\n","import { select } from 'd3';\nimport { log } from '../logger';\nimport { labelHelper, updateNodeBounds, insertPolygonShape } from './shapes/util';\nimport { getConfig } from '../config';\nimport intersect from './intersect/index.js';\nimport createLabel from './createLabel';\nimport note from './shapes/note';\nimport { parseMember } from '../diagrams/class/svgDraw';\nimport { evaluate } from '../diagrams/common/common';\n\nconst question = (parent, node) => {\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\n\n  const w = bbox.width + node.padding;\n  const h = bbox.height + node.padding;\n  const s = w + h;\n  const points = [\n    { x: s / 2, y: 0 },\n    { x: s, y: -s / 2 },\n    { x: s / 2, y: -s },\n    { x: 0, y: -s / 2 },\n  ];\n\n  log.info('Question main (Circle)');\n\n  const questionElem = insertPolygonShape(shapeSvg, s, s, points);\n  questionElem.attr('style', node.style);\n  updateNodeBounds(node, questionElem);\n\n  node.intersect = function (point) {\n    log.warn('Intersect called');\n    return intersect.polygon(node, points, point);\n  };\n\n  return shapeSvg;\n};\n\nconst choice = (parent, node) => {\n  const shapeSvg = parent\n    .insert('g')\n    .attr('class', 'node default')\n    .attr('id', node.domId || node.id);\n\n  const s = 28;\n  const points = [\n    { x: 0, y: s / 2 },\n    { x: s / 2, y: 0 },\n    { x: 0, y: -s / 2 },\n    { x: -s / 2, y: 0 },\n  ];\n\n  const choice = shapeSvg.insert('polygon', ':first-child').attr(\n    'points',\n    points\n      .map(function (d) {\n        return d.x + ',' + d.y;\n      })\n      .join(' ')\n  );\n  // center the circle around its coordinate\n  choice.attr('class', 'state-start').attr('r', 7).attr('width', 28).attr('height', 28);\n  node.width = 28;\n  node.height = 28;\n\n  node.intersect = function (point) {\n    return intersect.circle(node, 14, point);\n  };\n\n  return shapeSvg;\n};\n\nconst hexagon = (parent, node) => {\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\n\n  const f = 4;\n  const h = bbox.height + node.padding;\n  const m = h / f;\n  const w = bbox.width + 2 * m + node.padding;\n  const points = [\n    { x: m, y: 0 },\n    { x: w - m, y: 0 },\n    { x: w, y: -h / 2 },\n    { x: w - m, y: -h },\n    { x: m, y: -h },\n    { x: 0, y: -h / 2 },\n  ];\n\n  const hex = insertPolygonShape(shapeSvg, w, h, points);\n  hex.attr('style', node.style);\n  updateNodeBounds(node, hex);\n\n  node.intersect = function (point) {\n    return intersect.polygon(node, points, point);\n  };\n\n  return shapeSvg;\n};\n\nconst rect_left_inv_arrow = (parent, node) => {\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\n\n  const w = bbox.width + node.padding;\n  const h = bbox.height + node.padding;\n  const points = [\n    { x: -h / 2, y: 0 },\n    { x: w, y: 0 },\n    { x: w, y: -h },\n    { x: -h / 2, y: -h },\n    { x: 0, y: -h / 2 },\n  ];\n\n  const el = insertPolygonShape(shapeSvg, w, h, points);\n  el.attr('style', node.style);\n\n  node.width = w + h;\n  node.height = h;\n\n  node.intersect = function (point) {\n    return intersect.polygon(node, points, point);\n  };\n\n  return shapeSvg;\n};\n\nconst lean_right = (parent, node) => {\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\n\n  const w = bbox.width + node.padding;\n  const h = bbox.height + node.padding;\n  const points = [\n    { x: (-2 * h) / 6, y: 0 },\n    { x: w - h / 6, y: 0 },\n    { x: w + (2 * h) / 6, y: -h },\n    { x: h / 6, y: -h },\n  ];\n\n  const el = insertPolygonShape(shapeSvg, w, h, points);\n  el.attr('style', node.style);\n  updateNodeBounds(node, el);\n\n  node.intersect = function (point) {\n    return intersect.polygon(node, points, point);\n  };\n\n  return shapeSvg;\n};\n\nconst lean_left = (parent, node) => {\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\n\n  const w = bbox.width + node.padding;\n  const h = bbox.height + node.padding;\n  const points = [\n    { x: (2 * h) / 6, y: 0 },\n    { x: w + h / 6, y: 0 },\n    { x: w - (2 * h) / 6, y: -h },\n    { x: -h / 6, y: -h },\n  ];\n\n  const el = insertPolygonShape(shapeSvg, w, h, points);\n  el.attr('style', node.style);\n  updateNodeBounds(node, el);\n\n  node.intersect = function (point) {\n    return intersect.polygon(node, points, point);\n  };\n\n  return shapeSvg;\n};\n\nconst trapezoid = (parent, node) => {\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\n\n  const w = bbox.width + node.padding;\n  const h = bbox.height + node.padding;\n  const points = [\n    { x: (-2 * h) / 6, y: 0 },\n    { x: w + (2 * h) / 6, y: 0 },\n    { x: w - h / 6, y: -h },\n    { x: h / 6, y: -h },\n  ];\n\n  const el = insertPolygonShape(shapeSvg, w, h, points);\n  el.attr('style', node.style);\n  updateNodeBounds(node, el);\n\n  node.intersect = function (point) {\n    return intersect.polygon(node, points, point);\n  };\n\n  return shapeSvg;\n};\n\nconst inv_trapezoid = (parent, node) => {\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\n\n  const w = bbox.width + node.padding;\n  const h = bbox.height + node.padding;\n  const points = [\n    { x: h / 6, y: 0 },\n    { x: w - h / 6, y: 0 },\n    { x: w + (2 * h) / 6, y: -h },\n    { x: (-2 * h) / 6, y: -h },\n  ];\n\n  const el = insertPolygonShape(shapeSvg, w, h, points);\n  el.attr('style', node.style);\n  updateNodeBounds(node, el);\n\n  node.intersect = function (point) {\n    return intersect.polygon(node, points, point);\n  };\n\n  return shapeSvg;\n};\n\nconst rect_right_inv_arrow = (parent, node) => {\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\n\n  const w = bbox.width + node.padding;\n  const h = bbox.height + node.padding;\n  const points = [\n    { x: 0, y: 0 },\n    { x: w + h / 2, y: 0 },\n    { x: w, y: -h / 2 },\n    { x: w + h / 2, y: -h },\n    { x: 0, y: -h },\n  ];\n\n  const el = insertPolygonShape(shapeSvg, w, h, points);\n  el.attr('style', node.style);\n  updateNodeBounds(node, el);\n\n  node.intersect = function (point) {\n    return intersect.polygon(node, points, point);\n  };\n\n  return shapeSvg;\n};\n\nconst cylinder = (parent, node) => {\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\n\n  const w = bbox.width + node.padding;\n  const rx = w / 2;\n  const ry = rx / (2.5 + w / 50);\n  const h = bbox.height + ry + node.padding;\n\n  const shape =\n    'M 0,' +\n    ry +\n    ' a ' +\n    rx +\n    ',' +\n    ry +\n    ' 0,0,0 ' +\n    w +\n    ' 0 a ' +\n    rx +\n    ',' +\n    ry +\n    ' 0,0,0 ' +\n    -w +\n    ' 0 l 0,' +\n    h +\n    ' a ' +\n    rx +\n    ',' +\n    ry +\n    ' 0,0,0 ' +\n    w +\n    ' 0 l 0,' +\n    -h;\n\n  const el = shapeSvg\n    .attr('label-offset-y', ry)\n    .insert('path', ':first-child')\n    .attr('style', node.style)\n    .attr('d', shape)\n    .attr('transform', 'translate(' + -w / 2 + ',' + -(h / 2 + ry) + ')');\n\n  updateNodeBounds(node, el);\n\n  node.intersect = function (point) {\n    const pos = intersect.rect(node, point);\n    const x = pos.x - node.x;\n\n    if (\n      rx != 0 &&\n      (Math.abs(x) < node.width / 2 ||\n        (Math.abs(x) == node.width / 2 && Math.abs(pos.y - node.y) > node.height / 2 - ry))\n    ) {\n      // ellipsis equation: x*x / a*a + y*y / b*b = 1\n      // solve for y to get adjusted value for pos.y\n      let y = ry * ry * (1 - (x * x) / (rx * rx));\n      if (y != 0) {\n        y = Math.sqrt(y);\n      }\n      y = ry - y;\n      if (point.y - node.y > 0) {\n        y = -y;\n      }\n\n      pos.y += y;\n    }\n\n    return pos;\n  };\n\n  return shapeSvg;\n};\n\nconst rect = (parent, node) => {\n  const { shapeSvg, bbox, halfPadding } = labelHelper(parent, node, 'node ' + node.classes, true);\n\n  // add the rect\n  const rect = shapeSvg.insert('rect', ':first-child');\n\n  // const totalWidth = bbox.width + node.padding * 2;\n  // const totalHeight = bbox.height + node.padding * 2;\n  const totalWidth = bbox.width + node.padding;\n  const totalHeight = bbox.height + node.padding;\n  rect\n    .attr('class', 'basic label-container')\n    .attr('style', node.style)\n    .attr('rx', node.rx)\n    .attr('ry', node.ry)\n    // .attr('x', -bbox.width / 2 - node.padding)\n    // .attr('y', -bbox.height / 2 - node.padding)\n    .attr('x', -bbox.width / 2 - halfPadding)\n    .attr('y', -bbox.height / 2 - halfPadding)\n    .attr('width', totalWidth)\n    .attr('height', totalHeight);\n\n  if (node.props) {\n    const propKeys = new Set(Object.keys(node.props));\n    if (node.props.borders) {\n      applyNodePropertyBorders(rect, node.props.borders, totalWidth, totalHeight);\n      propKeys.delete('borders');\n    }\n    propKeys.forEach((propKey) => {\n      log.warn(`Unknown node property ${propKey}`);\n    });\n  }\n\n  updateNodeBounds(node, rect);\n\n  node.intersect = function (point) {\n    return intersect.rect(node, point);\n  };\n\n  return shapeSvg;\n};\n\nconst labelRect = (parent, node) => {\n  const { shapeSvg } = labelHelper(parent, node, 'label', true);\n\n  log.trace('Classes = ', node.classes);\n  // add the rect\n  const rect = shapeSvg.insert('rect', ':first-child');\n\n  // Hide the rect we are only after the label\n  const totalWidth = 0;\n  const totalHeight = 0;\n  rect.attr('width', totalWidth).attr('height', totalHeight);\n  shapeSvg.attr('class', 'label edgeLabel');\n\n  if (node.props) {\n    const propKeys = new Set(Object.keys(node.props));\n    if (node.props.borders) {\n      applyNodePropertyBorders(rect, node.props.borders, totalWidth, totalHeight);\n      propKeys.delete('borders');\n    }\n    propKeys.forEach((propKey) => {\n      log.warn(`Unknown node property ${propKey}`);\n    });\n  }\n\n  updateNodeBounds(node, rect);\n\n  node.intersect = function (point) {\n    return intersect.rect(node, point);\n  };\n\n  return shapeSvg;\n};\n\n/**\n * @param rect\n * @param borders\n * @param totalWidth\n * @param totalHeight\n */\nfunction applyNodePropertyBorders(rect, borders, totalWidth, totalHeight) {\n  const strokeDashArray = [];\n  const addBorder = (length) => {\n    strokeDashArray.push(length, 0);\n  };\n  const skipBorder = (length) => {\n    strokeDashArray.push(0, length);\n  };\n  if (borders.includes('t')) {\n    log.debug('add top border');\n    addBorder(totalWidth);\n  } else {\n    skipBorder(totalWidth);\n  }\n  if (borders.includes('r')) {\n    log.debug('add right border');\n    addBorder(totalHeight);\n  } else {\n    skipBorder(totalHeight);\n  }\n  if (borders.includes('b')) {\n    log.debug('add bottom border');\n    addBorder(totalWidth);\n  } else {\n    skipBorder(totalWidth);\n  }\n  if (borders.includes('l')) {\n    log.debug('add left border');\n    addBorder(totalHeight);\n  } else {\n    skipBorder(totalHeight);\n  }\n  rect.attr('stroke-dasharray', strokeDashArray.join(' '));\n}\n\nconst rectWithTitle = (parent, node) => {\n  // const { shapeSvg, bbox, halfPadding } = labelHelper(parent, node, 'node ' + node.classes);\n\n  let classes;\n  if (!node.classes) {\n    classes = 'node default';\n  } else {\n    classes = 'node ' + node.classes;\n  }\n  // Add outer g element\n  const shapeSvg = parent\n    .insert('g')\n    .attr('class', classes)\n    .attr('id', node.domId || node.id);\n\n  // Create the title label and insert it after the rect\n  const rect = shapeSvg.insert('rect', ':first-child');\n  // const innerRect = shapeSvg.insert('rect');\n  const innerLine = shapeSvg.insert('line');\n\n  const label = shapeSvg.insert('g').attr('class', 'label');\n\n  const text2 = node.labelText.flat ? node.labelText.flat() : node.labelText;\n  // const text2 = typeof text2prim === 'object' ? text2prim[0] : text2prim;\n\n  let title = '';\n  if (typeof text2 === 'object') {\n    title = text2[0];\n  } else {\n    title = text2;\n  }\n  log.info('Label text abc79', title, text2, typeof text2 === 'object');\n\n  const text = label.node().appendChild(createLabel(title, node.labelStyle, true, true));\n  let bbox = { width: 0, height: 0 };\n  if (evaluate(getConfig().flowchart.htmlLabels)) {\n    const div = text.children[0];\n    const dv = select(text);\n    bbox = div.getBoundingClientRect();\n    dv.attr('width', bbox.width);\n    dv.attr('height', bbox.height);\n  }\n  log.info('Text 2', text2);\n  const textRows = text2.slice(1, text2.length);\n  let titleBox = text.getBBox();\n  const descr = label\n    .node()\n    .appendChild(\n      createLabel(textRows.join ? textRows.join('<br/>') : textRows, node.labelStyle, true, true)\n    );\n\n  if (evaluate(getConfig().flowchart.htmlLabels)) {\n    const div = descr.children[0];\n    const dv = select(descr);\n    bbox = div.getBoundingClientRect();\n    dv.attr('width', bbox.width);\n    dv.attr('height', bbox.height);\n  }\n  // bbox = label.getBBox();\n  // log.info(descr);\n  const halfPadding = node.padding / 2;\n  select(descr).attr(\n    'transform',\n    'translate( ' +\n      // (titleBox.width - bbox.width) / 2 +\n      (bbox.width > titleBox.width ? 0 : (titleBox.width - bbox.width) / 2) +\n      ', ' +\n      (titleBox.height + halfPadding + 5) +\n      ')'\n  );\n  select(text).attr(\n    'transform',\n    'translate( ' +\n      // (titleBox.width - bbox.width) / 2 +\n      (bbox.width < titleBox.width ? 0 : -(titleBox.width - bbox.width) / 2) +\n      ', ' +\n      0 +\n      ')'\n  );\n  // Get the size of the label\n\n  // Bounding box for title and text\n  bbox = label.node().getBBox();\n\n  // Center the label\n  label.attr(\n    'transform',\n    'translate(' + -bbox.width / 2 + ', ' + (-bbox.height / 2 - halfPadding + 3) + ')'\n  );\n\n  rect\n    .attr('class', 'outer title-state')\n    .attr('x', -bbox.width / 2 - halfPadding)\n    .attr('y', -bbox.height / 2 - halfPadding)\n    .attr('width', bbox.width + node.padding)\n    .attr('height', bbox.height + node.padding);\n\n  innerLine\n    .attr('class', 'divider')\n    .attr('x1', -bbox.width / 2 - halfPadding)\n    .attr('x2', bbox.width / 2 + halfPadding)\n    .attr('y1', -bbox.height / 2 - halfPadding + titleBox.height + halfPadding)\n    .attr('y2', -bbox.height / 2 - halfPadding + titleBox.height + halfPadding);\n\n  updateNodeBounds(node, rect);\n\n  node.intersect = function (point) {\n    return intersect.rect(node, point);\n  };\n\n  return shapeSvg;\n};\n\nconst stadium = (parent, node) => {\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\n\n  const h = bbox.height + node.padding;\n  const w = bbox.width + h / 4 + node.padding;\n\n  // add the rect\n  const rect = shapeSvg\n    .insert('rect', ':first-child')\n    .attr('style', node.style)\n    .attr('rx', h / 2)\n    .attr('ry', h / 2)\n    .attr('x', -w / 2)\n    .attr('y', -h / 2)\n    .attr('width', w)\n    .attr('height', h);\n\n  updateNodeBounds(node, rect);\n\n  node.intersect = function (point) {\n    return intersect.rect(node, point);\n  };\n\n  return shapeSvg;\n};\n\nconst circle = (parent, node) => {\n  const { shapeSvg, bbox, halfPadding } = labelHelper(parent, node, undefined, true);\n  const circle = shapeSvg.insert('circle', ':first-child');\n\n  // center the circle around its coordinate\n  circle\n    .attr('style', node.style)\n    .attr('rx', node.rx)\n    .attr('ry', node.ry)\n    .attr('r', bbox.width / 2 + halfPadding)\n    .attr('width', bbox.width + node.padding)\n    .attr('height', bbox.height + node.padding);\n\n  log.info('Circle main');\n\n  updateNodeBounds(node, circle);\n\n  node.intersect = function (point) {\n    log.info('Circle intersect', node, bbox.width / 2 + halfPadding, point);\n    return intersect.circle(node, bbox.width / 2 + halfPadding, point);\n  };\n\n  return shapeSvg;\n};\n\nconst doublecircle = (parent, node) => {\n  const { shapeSvg, bbox, halfPadding } = labelHelper(parent, node, undefined, true);\n  const gap = 5;\n  const circleGroup = shapeSvg.insert('g', ':first-child');\n  const outerCircle = circleGroup.insert('circle');\n  const innerCircle = circleGroup.insert('circle');\n\n  // center the circle around its coordinate\n  outerCircle\n    .attr('style', node.style)\n    .attr('rx', node.rx)\n    .attr('ry', node.ry)\n    .attr('r', bbox.width / 2 + halfPadding + gap)\n    .attr('width', bbox.width + node.padding + gap * 2)\n    .attr('height', bbox.height + node.padding + gap * 2);\n\n  innerCircle\n    .attr('style', node.style)\n    .attr('rx', node.rx)\n    .attr('ry', node.ry)\n    .attr('r', bbox.width / 2 + halfPadding)\n    .attr('width', bbox.width + node.padding)\n    .attr('height', bbox.height + node.padding);\n\n  log.info('DoubleCircle main');\n\n  updateNodeBounds(node, outerCircle);\n\n  node.intersect = function (point) {\n    log.info('DoubleCircle intersect', node, bbox.width / 2 + halfPadding + gap, point);\n    return intersect.circle(node, bbox.width / 2 + halfPadding + gap, point);\n  };\n\n  return shapeSvg;\n};\n\nconst subroutine = (parent, node) => {\n  const { shapeSvg, bbox } = labelHelper(parent, node, undefined, true);\n\n  const w = bbox.width + node.padding;\n  const h = bbox.height + node.padding;\n  const points = [\n    { x: 0, y: 0 },\n    { x: w, y: 0 },\n    { x: w, y: -h },\n    { x: 0, y: -h },\n    { x: 0, y: 0 },\n    { x: -8, y: 0 },\n    { x: w + 8, y: 0 },\n    { x: w + 8, y: -h },\n    { x: -8, y: -h },\n    { x: -8, y: 0 },\n  ];\n\n  const el = insertPolygonShape(shapeSvg, w, h, points);\n  el.attr('style', node.style);\n  updateNodeBounds(node, el);\n\n  node.intersect = function (point) {\n    return intersect.polygon(node, points, point);\n  };\n\n  return shapeSvg;\n};\n\nconst start = (parent, node) => {\n  const shapeSvg = parent\n    .insert('g')\n    .attr('class', 'node default')\n    .attr('id', node.domId || node.id);\n  const circle = shapeSvg.insert('circle', ':first-child');\n\n  // center the circle around its coordinate\n  circle.attr('class', 'state-start').attr('r', 7).attr('width', 14).attr('height', 14);\n\n  updateNodeBounds(node, circle);\n\n  node.intersect = function (point) {\n    return intersect.circle(node, 7, point);\n  };\n\n  return shapeSvg;\n};\n\nconst forkJoin = (parent, node, dir) => {\n  const shapeSvg = parent\n    .insert('g')\n    .attr('class', 'node default')\n    .attr('id', node.domId || node.id);\n\n  let width = 70;\n  let height = 10;\n\n  if (dir === 'LR') {\n    width = 10;\n    height = 70;\n  }\n\n  const shape = shapeSvg\n    .append('rect')\n    .attr('x', (-1 * width) / 2)\n    .attr('y', (-1 * height) / 2)\n    .attr('width', width)\n    .attr('height', height)\n    .attr('class', 'fork-join');\n\n  updateNodeBounds(node, shape);\n  node.height = node.height + node.padding / 2;\n  node.width = node.width + node.padding / 2;\n  node.intersect = function (point) {\n    return intersect.rect(node, point);\n  };\n\n  return shapeSvg;\n};\n\nconst end = (parent, node) => {\n  const shapeSvg = parent\n    .insert('g')\n    .attr('class', 'node default')\n    .attr('id', node.domId || node.id);\n  const innerCircle = shapeSvg.insert('circle', ':first-child');\n  const circle = shapeSvg.insert('circle', ':first-child');\n\n  circle.attr('class', 'state-start').attr('r', 7).attr('width', 14).attr('height', 14);\n\n  innerCircle.attr('class', 'state-end').attr('r', 5).attr('width', 10).attr('height', 10);\n\n  updateNodeBounds(node, circle);\n\n  node.intersect = function (point) {\n    return intersect.circle(node, 7, point);\n  };\n\n  return shapeSvg;\n};\n\nconst class_box = (parent, node) => {\n  const halfPadding = node.padding / 2;\n  const rowPadding = 4;\n  const lineHeight = 8;\n\n  let classes;\n  if (!node.classes) {\n    classes = 'node default';\n  } else {\n    classes = 'node ' + node.classes;\n  }\n  // Add outer g element\n  const shapeSvg = parent\n    .insert('g')\n    .attr('class', classes)\n    .attr('id', node.domId || node.id);\n\n  // Create the title label and insert it after the rect\n  const rect = shapeSvg.insert('rect', ':first-child');\n  const topLine = shapeSvg.insert('line');\n  const bottomLine = shapeSvg.insert('line');\n  let maxWidth = 0;\n  let maxHeight = rowPadding;\n\n  const labelContainer = shapeSvg.insert('g').attr('class', 'label');\n  let verticalPos = 0;\n  const hasInterface = node.classData.annotations && node.classData.annotations[0];\n\n  // 1. Create the labels\n  const interfaceLabelText = node.classData.annotations[0]\n    ? '«' + node.classData.annotations[0] + '»'\n    : '';\n  const interfaceLabel = labelContainer\n    .node()\n    .appendChild(createLabel(interfaceLabelText, node.labelStyle, true, true));\n  let interfaceBBox = interfaceLabel.getBBox();\n  if (evaluate(getConfig().flowchart.htmlLabels)) {\n    const div = interfaceLabel.children[0];\n    const dv = select(interfaceLabel);\n    interfaceBBox = div.getBoundingClientRect();\n    dv.attr('width', interfaceBBox.width);\n    dv.attr('height', interfaceBBox.height);\n  }\n  if (node.classData.annotations[0]) {\n    maxHeight += interfaceBBox.height + rowPadding;\n    maxWidth += interfaceBBox.width;\n  }\n\n  let classTitleString = node.classData.label;\n\n  if (node.classData.type !== undefined && node.classData.type !== '') {\n    if (getConfig().flowchart.htmlLabels) {\n      classTitleString += '&lt;' + node.classData.type + '&gt;';\n    } else {\n      classTitleString += '<' + node.classData.type + '>';\n    }\n  }\n  const classTitleLabel = labelContainer\n    .node()\n    .appendChild(createLabel(classTitleString, node.labelStyle, true, true));\n  select(classTitleLabel).attr('class', 'classTitle');\n  let classTitleBBox = classTitleLabel.getBBox();\n  if (evaluate(getConfig().flowchart.htmlLabels)) {\n    const div = classTitleLabel.children[0];\n    const dv = select(classTitleLabel);\n    classTitleBBox = div.getBoundingClientRect();\n    dv.attr('width', classTitleBBox.width);\n    dv.attr('height', classTitleBBox.height);\n  }\n  maxHeight += classTitleBBox.height + rowPadding;\n  if (classTitleBBox.width > maxWidth) {\n    maxWidth = classTitleBBox.width;\n  }\n  const classAttributes = [];\n  node.classData.members.forEach((str) => {\n    const parsedInfo = parseMember(str);\n    let parsedText = parsedInfo.displayText;\n    if (getConfig().flowchart.htmlLabels) {\n      parsedText = parsedText.replace(/</g, '&lt;').replace(/>/g, '&gt;');\n    }\n    const lbl = labelContainer\n      .node()\n      .appendChild(\n        createLabel(\n          parsedText,\n          parsedInfo.cssStyle ? parsedInfo.cssStyle : node.labelStyle,\n          true,\n          true\n        )\n      );\n    let bbox = lbl.getBBox();\n    if (evaluate(getConfig().flowchart.htmlLabels)) {\n      const div = lbl.children[0];\n      const dv = select(lbl);\n      bbox = div.getBoundingClientRect();\n      dv.attr('width', bbox.width);\n      dv.attr('height', bbox.height);\n    }\n    if (bbox.width > maxWidth) {\n      maxWidth = bbox.width;\n    }\n    maxHeight += bbox.height + rowPadding;\n    classAttributes.push(lbl);\n  });\n\n  maxHeight += lineHeight;\n\n  const classMethods = [];\n  node.classData.methods.forEach((str) => {\n    const parsedInfo = parseMember(str);\n    let displayText = parsedInfo.displayText;\n    if (getConfig().flowchart.htmlLabels) {\n      displayText = displayText.replace(/</g, '&lt;').replace(/>/g, '&gt;');\n    }\n    const lbl = labelContainer\n      .node()\n      .appendChild(\n        createLabel(\n          displayText,\n          parsedInfo.cssStyle ? parsedInfo.cssStyle : node.labelStyle,\n          true,\n          true\n        )\n      );\n    let bbox = lbl.getBBox();\n    if (evaluate(getConfig().flowchart.htmlLabels)) {\n      const div = lbl.children[0];\n      const dv = select(lbl);\n      bbox = div.getBoundingClientRect();\n      dv.attr('width', bbox.width);\n      dv.attr('height', bbox.height);\n    }\n    if (bbox.width > maxWidth) {\n      maxWidth = bbox.width;\n    }\n    maxHeight += bbox.height + rowPadding;\n\n    classMethods.push(lbl);\n  });\n\n  maxHeight += lineHeight;\n\n  // 2. Position the labels\n\n  // position the interface label\n  if (hasInterface) {\n    let diffX = (maxWidth - interfaceBBox.width) / 2;\n    select(interfaceLabel).attr(\n      'transform',\n      'translate( ' + ((-1 * maxWidth) / 2 + diffX) + ', ' + (-1 * maxHeight) / 2 + ')'\n    );\n    verticalPos = interfaceBBox.height + rowPadding;\n  }\n  // Position the class title label\n  let diffX = (maxWidth - classTitleBBox.width) / 2;\n  select(classTitleLabel).attr(\n    'transform',\n    'translate( ' +\n      ((-1 * maxWidth) / 2 + diffX) +\n      ', ' +\n      ((-1 * maxHeight) / 2 + verticalPos) +\n      ')'\n  );\n  verticalPos += classTitleBBox.height + rowPadding;\n\n  topLine\n    .attr('class', 'divider')\n    .attr('x1', -maxWidth / 2 - halfPadding)\n    .attr('x2', maxWidth / 2 + halfPadding)\n    .attr('y1', -maxHeight / 2 - halfPadding + lineHeight + verticalPos)\n    .attr('y2', -maxHeight / 2 - halfPadding + lineHeight + verticalPos);\n\n  verticalPos += lineHeight;\n\n  classAttributes.forEach((lbl) => {\n    select(lbl).attr(\n      'transform',\n      'translate( ' +\n        -maxWidth / 2 +\n        ', ' +\n        ((-1 * maxHeight) / 2 + verticalPos + lineHeight / 2) +\n        ')'\n    );\n    verticalPos += classTitleBBox.height + rowPadding;\n  });\n\n  verticalPos += lineHeight;\n  bottomLine\n    .attr('class', 'divider')\n    .attr('x1', -maxWidth / 2 - halfPadding)\n    .attr('x2', maxWidth / 2 + halfPadding)\n    .attr('y1', -maxHeight / 2 - halfPadding + lineHeight + verticalPos)\n    .attr('y2', -maxHeight / 2 - halfPadding + lineHeight + verticalPos);\n\n  verticalPos += lineHeight;\n\n  classMethods.forEach((lbl) => {\n    select(lbl).attr(\n      'transform',\n      'translate( ' + -maxWidth / 2 + ', ' + ((-1 * maxHeight) / 2 + verticalPos) + ')'\n    );\n    verticalPos += classTitleBBox.height + rowPadding;\n  });\n\n  rect\n    .attr('class', 'outer title-state')\n    .attr('x', -maxWidth / 2 - halfPadding)\n    .attr('y', -(maxHeight / 2) - halfPadding)\n    .attr('width', maxWidth + node.padding)\n    .attr('height', maxHeight + node.padding);\n\n  updateNodeBounds(node, rect);\n\n  node.intersect = function (point) {\n    return intersect.rect(node, point);\n  };\n\n  return shapeSvg;\n};\n\nconst shapes = {\n  rhombus: question,\n  question,\n  rect,\n  labelRect,\n  rectWithTitle,\n  choice,\n  circle,\n  doublecircle,\n  stadium,\n  hexagon,\n  rect_left_inv_arrow,\n  lean_right,\n  lean_left,\n  trapezoid,\n  inv_trapezoid,\n  rect_right_inv_arrow,\n  cylinder,\n  start,\n  end,\n  note,\n  subroutine,\n  fork: forkJoin,\n  join: forkJoin,\n  class_box,\n};\n\nlet nodeElems = {};\n\nexport const insertNode = (elem, node, dir) => {\n  let newEl;\n  let el;\n\n  // Add link when appropriate\n  if (node.link) {\n    let target;\n    if (getConfig().securityLevel === 'sandbox') {\n      target = '_top';\n    } else if (node.linkTarget) {\n      target = node.linkTarget || '_blank';\n    }\n    newEl = elem.insert('svg:a').attr('xlink:href', node.link).attr('target', target);\n    el = shapes[node.shape](newEl, node, dir);\n  } else {\n    el = shapes[node.shape](elem, node, dir);\n    newEl = el;\n  }\n  if (node.tooltip) {\n    el.attr('title', node.tooltip);\n  }\n  if (node.class) {\n    el.attr('class', 'node default ' + node.class);\n  }\n\n  nodeElems[node.id] = newEl;\n\n  if (node.haveCallback) {\n    nodeElems[node.id].attr('class', nodeElems[node.id].attr('class') + ' clickable');\n  }\n  return newEl;\n};\nexport const setNodeElem = (elem, node) => {\n  nodeElems[node.id] = elem;\n};\nexport const clear = () => {\n  nodeElems = {};\n};\n\nexport const positionNode = (node) => {\n  const el = nodeElems[node.id];\n  log.trace(\n    'Transforming node',\n    node.diff,\n    node,\n    'translate(' + (node.x - node.width / 2 - 5) + ', ' + node.width / 2 + ')'\n  );\n  const padding = 8;\n  const diff = node.diff || 0;\n  if (node.clusterNode) {\n    el.attr(\n      'transform',\n      'translate(' +\n        (node.x + diff - node.width / 2) +\n        ', ' +\n        (node.y - node.height / 2 - padding) +\n        ')'\n    );\n  } else {\n    el.attr('transform', 'translate(' + node.x + ', ' + node.y + ')');\n  }\n  return diff;\n};\n","import { log } from '../logger';\nimport createLabel from './createLabel';\nimport { createText } from '../rendering-util/createText';\nimport { line, curveBasis, select } from 'd3';\nimport { getConfig } from '../config';\nimport utils from '../utils';\nimport { evaluate } from '../diagrams/common/common';\n\nlet edgeLabels = {};\nlet terminalLabels = {};\n\nexport const clear = () => {\n  edgeLabels = {};\n  terminalLabels = {};\n};\n\nexport const insertEdgeLabel = (elem, edge) => {\n  const useHtmlLabels = evaluate(getConfig().flowchart.htmlLabels);\n  // Create the actual text element\n  const labelElement =\n    edge.labelType === 'markdown'\n      ? createText(elem, edge.label, {\n          style: edge.labelStyle,\n          useHtmlLabels,\n          addSvgBackground: true,\n        })\n      : createLabel(edge.label, edge.labelStyle);\n  log.info('abc82', edge, edge.labelType);\n\n  // Create outer g, edgeLabel, this will be positioned after graph layout\n  const edgeLabel = elem.insert('g').attr('class', 'edgeLabel');\n\n  // Create inner g, label, this will be positioned now for centering the text\n  const label = edgeLabel.insert('g').attr('class', 'label');\n  label.node().appendChild(labelElement);\n\n  // Center the label\n  let bbox = labelElement.getBBox();\n  if (useHtmlLabels) {\n    const div = labelElement.children[0];\n    const dv = select(labelElement);\n    bbox = div.getBoundingClientRect();\n    dv.attr('width', bbox.width);\n    dv.attr('height', bbox.height);\n  }\n  label.attr('transform', 'translate(' + -bbox.width / 2 + ', ' + -bbox.height / 2 + ')');\n\n  // Make element accessible by id for positioning\n  edgeLabels[edge.id] = edgeLabel;\n\n  // Update the abstract data of the edge with the new information about its width and height\n  edge.width = bbox.width;\n  edge.height = bbox.height;\n\n  let fo;\n  if (edge.startLabelLeft) {\n    // Create the actual text element\n    const startLabelElement = createLabel(edge.startLabelLeft, edge.labelStyle);\n    const startEdgeLabelLeft = elem.insert('g').attr('class', 'edgeTerminals');\n    const inner = startEdgeLabelLeft.insert('g').attr('class', 'inner');\n    fo = inner.node().appendChild(startLabelElement);\n    const slBox = startLabelElement.getBBox();\n    inner.attr('transform', 'translate(' + -slBox.width / 2 + ', ' + -slBox.height / 2 + ')');\n    if (!terminalLabels[edge.id]) {\n      terminalLabels[edge.id] = {};\n    }\n    terminalLabels[edge.id].startLeft = startEdgeLabelLeft;\n    setTerminalWidth(fo, edge.startLabelLeft);\n  }\n  if (edge.startLabelRight) {\n    // Create the actual text element\n    const startLabelElement = createLabel(edge.startLabelRight, edge.labelStyle);\n    const startEdgeLabelRight = elem.insert('g').attr('class', 'edgeTerminals');\n    const inner = startEdgeLabelRight.insert('g').attr('class', 'inner');\n    fo = startEdgeLabelRight.node().appendChild(startLabelElement);\n    inner.node().appendChild(startLabelElement);\n    const slBox = startLabelElement.getBBox();\n    inner.attr('transform', 'translate(' + -slBox.width / 2 + ', ' + -slBox.height / 2 + ')');\n\n    if (!terminalLabels[edge.id]) {\n      terminalLabels[edge.id] = {};\n    }\n    terminalLabels[edge.id].startRight = startEdgeLabelRight;\n    setTerminalWidth(fo, edge.startLabelRight);\n  }\n  if (edge.endLabelLeft) {\n    // Create the actual text element\n    const endLabelElement = createLabel(edge.endLabelLeft, edge.labelStyle);\n    const endEdgeLabelLeft = elem.insert('g').attr('class', 'edgeTerminals');\n    const inner = endEdgeLabelLeft.insert('g').attr('class', 'inner');\n    fo = inner.node().appendChild(endLabelElement);\n    const slBox = endLabelElement.getBBox();\n    inner.attr('transform', 'translate(' + -slBox.width / 2 + ', ' + -slBox.height / 2 + ')');\n\n    endEdgeLabelLeft.node().appendChild(endLabelElement);\n\n    if (!terminalLabels[edge.id]) {\n      terminalLabels[edge.id] = {};\n    }\n    terminalLabels[edge.id].endLeft = endEdgeLabelLeft;\n    setTerminalWidth(fo, edge.endLabelLeft);\n  }\n  if (edge.endLabelRight) {\n    // Create the actual text element\n    const endLabelElement = createLabel(edge.endLabelRight, edge.labelStyle);\n    const endEdgeLabelRight = elem.insert('g').attr('class', 'edgeTerminals');\n    const inner = endEdgeLabelRight.insert('g').attr('class', 'inner');\n\n    fo = inner.node().appendChild(endLabelElement);\n    const slBox = endLabelElement.getBBox();\n    inner.attr('transform', 'translate(' + -slBox.width / 2 + ', ' + -slBox.height / 2 + ')');\n\n    endEdgeLabelRight.node().appendChild(endLabelElement);\n    if (!terminalLabels[edge.id]) {\n      terminalLabels[edge.id] = {};\n    }\n    terminalLabels[edge.id].endRight = endEdgeLabelRight;\n    setTerminalWidth(fo, edge.endLabelRight);\n  }\n  return labelElement;\n};\n\n/**\n * @param {any} fo\n * @param {any} value\n */\nfunction setTerminalWidth(fo, value) {\n  if (getConfig().flowchart.htmlLabels && fo) {\n    fo.style.width = value.length * 9 + 'px';\n    fo.style.height = '12px';\n  }\n}\n\nexport const positionEdgeLabel = (edge, paths) => {\n  log.info('Moving label abc78 ', edge.id, edge.label, edgeLabels[edge.id]);\n  let path = paths.updatedPath ? paths.updatedPath : paths.originalPath;\n  if (edge.label) {\n    const el = edgeLabels[edge.id];\n    let x = edge.x;\n    let y = edge.y;\n    if (path) {\n      //   // debugger;\n      const pos = utils.calcLabelPosition(path);\n      log.info(\n        'Moving label ' + edge.label + ' from (',\n        x,\n        ',',\n        y,\n        ') to (',\n        pos.x,\n        ',',\n        pos.y,\n        ') abc78'\n      );\n      if (paths.updatedPath) {\n        x = pos.x;\n        y = pos.y;\n      }\n    }\n    el.attr('transform', 'translate(' + x + ', ' + y + ')');\n  }\n\n  //let path = paths.updatedPath ? paths.updatedPath : paths.originalPath;\n  if (edge.startLabelLeft) {\n    const el = terminalLabels[edge.id].startLeft;\n    let x = edge.x;\n    let y = edge.y;\n    if (path) {\n      // debugger;\n      const pos = utils.calcTerminalLabelPosition(edge.arrowTypeStart ? 10 : 0, 'start_left', path);\n      x = pos.x;\n      y = pos.y;\n    }\n    el.attr('transform', 'translate(' + x + ', ' + y + ')');\n  }\n  if (edge.startLabelRight) {\n    const el = terminalLabels[edge.id].startRight;\n    let x = edge.x;\n    let y = edge.y;\n    if (path) {\n      // debugger;\n      const pos = utils.calcTerminalLabelPosition(\n        edge.arrowTypeStart ? 10 : 0,\n        'start_right',\n        path\n      );\n      x = pos.x;\n      y = pos.y;\n    }\n    el.attr('transform', 'translate(' + x + ', ' + y + ')');\n  }\n  if (edge.endLabelLeft) {\n    const el = terminalLabels[edge.id].endLeft;\n    let x = edge.x;\n    let y = edge.y;\n    if (path) {\n      // debugger;\n      const pos = utils.calcTerminalLabelPosition(edge.arrowTypeEnd ? 10 : 0, 'end_left', path);\n      x = pos.x;\n      y = pos.y;\n    }\n    el.attr('transform', 'translate(' + x + ', ' + y + ')');\n  }\n  if (edge.endLabelRight) {\n    const el = terminalLabels[edge.id].endRight;\n    let x = edge.x;\n    let y = edge.y;\n    if (path) {\n      // debugger;\n      const pos = utils.calcTerminalLabelPosition(edge.arrowTypeEnd ? 10 : 0, 'end_right', path);\n      x = pos.x;\n      y = pos.y;\n    }\n    el.attr('transform', 'translate(' + x + ', ' + y + ')');\n  }\n};\n\nconst outsideNode = (node, point) => {\n  // log.warn('Checking bounds ', node, point);\n  const x = node.x;\n  const y = node.y;\n  const dx = Math.abs(point.x - x);\n  const dy = Math.abs(point.y - y);\n  const w = node.width / 2;\n  const h = node.height / 2;\n  if (dx >= w || dy >= h) {\n    return true;\n  }\n  return false;\n};\n\nexport const intersection = (node, outsidePoint, insidePoint) => {\n  log.warn(`intersection calc abc89:\n  outsidePoint: ${JSON.stringify(outsidePoint)}\n  insidePoint : ${JSON.stringify(insidePoint)}\n  node        : x:${node.x} y:${node.y} w:${node.width} h:${node.height}`);\n  const x = node.x;\n  const y = node.y;\n\n  const dx = Math.abs(x - insidePoint.x);\n  // const dy = Math.abs(y - insidePoint.y);\n  const w = node.width / 2;\n  let r = insidePoint.x < outsidePoint.x ? w - dx : w + dx;\n  const h = node.height / 2;\n\n  // const edges = {\n  //   x1: x - w,\n  //   x2: x + w,\n  //   y1: y - h,\n  //   y2: y + h\n  // };\n\n  // if (\n  //   outsidePoint.x === edges.x1 ||\n  //   outsidePoint.x === edges.x2 ||\n  //   outsidePoint.y === edges.y1 ||\n  //   outsidePoint.y === edges.y2\n  // ) {\n  //   log.warn('abc89 calc equals on edge', outsidePoint, edges);\n  //   return outsidePoint;\n  // }\n\n  const Q = Math.abs(outsidePoint.y - insidePoint.y);\n  const R = Math.abs(outsidePoint.x - insidePoint.x);\n  // log.warn();\n  if (Math.abs(y - outsidePoint.y) * w > Math.abs(x - outsidePoint.x) * h) {\n    // Intersection is top or bottom of rect.\n    // let q = insidePoint.y < outsidePoint.y ? outsidePoint.y - h - y : y - h - outsidePoint.y;\n    let q = insidePoint.y < outsidePoint.y ? outsidePoint.y - h - y : y - h - outsidePoint.y;\n    r = (R * q) / Q;\n    const res = {\n      x: insidePoint.x < outsidePoint.x ? insidePoint.x + r : insidePoint.x - R + r,\n      y: insidePoint.y < outsidePoint.y ? insidePoint.y + Q - q : insidePoint.y - Q + q,\n    };\n\n    if (r === 0) {\n      res.x = outsidePoint.x;\n      res.y = outsidePoint.y;\n    }\n    if (R === 0) {\n      res.x = outsidePoint.x;\n    }\n    if (Q === 0) {\n      res.y = outsidePoint.y;\n    }\n\n    log.warn(`abc89 topp/bott calc, Q ${Q}, q ${q}, R ${R}, r ${r}`, res);\n\n    return res;\n  } else {\n    // Intersection onn sides of rect\n    if (insidePoint.x < outsidePoint.x) {\n      r = outsidePoint.x - w - x;\n    } else {\n      // r = outsidePoint.x - w - x;\n      r = x - w - outsidePoint.x;\n    }\n    let q = (Q * r) / R;\n    //  OK let _x = insidePoint.x < outsidePoint.x ? insidePoint.x + R - r : insidePoint.x + dx - w;\n    // OK let _x = insidePoint.x < outsidePoint.x ? insidePoint.x + R - r : outsidePoint.x + r;\n    let _x = insidePoint.x < outsidePoint.x ? insidePoint.x + R - r : insidePoint.x - R + r;\n    // let _x = insidePoint.x < outsidePoint.x ? insidePoint.x + R - r : outsidePoint.x + r;\n    let _y = insidePoint.y < outsidePoint.y ? insidePoint.y + q : insidePoint.y - q;\n    log.warn(`sides calc abc89, Q ${Q}, q ${q}, R ${R}, r ${r}`, { _x, _y });\n    if (r === 0) {\n      _x = outsidePoint.x;\n      _y = outsidePoint.y;\n    }\n    if (R === 0) {\n      _x = outsidePoint.x;\n    }\n    if (Q === 0) {\n      _y = outsidePoint.y;\n    }\n\n    return { x: _x, y: _y };\n  }\n};\n/**\n * This function will page a path and node where the last point(s) in the path is inside the node\n * and return an update path ending by the border of the node.\n *\n * @param {Array} _points\n * @param {any} boundryNode\n * @returns {Array} Points\n */\nconst cutPathAtIntersect = (_points, boundryNode) => {\n  log.warn('abc88 cutPathAtIntersect', _points, boundryNode);\n  let points = [];\n  let lastPointOutside = _points[0];\n  let isInside = false;\n  _points.forEach((point) => {\n    // const node = clusterDb[edge.toCluster].node;\n    log.info('abc88 checking point', point, boundryNode);\n\n    // check if point is inside the boundary rect\n    if (!outsideNode(boundryNode, point) && !isInside) {\n      // First point inside the rect found\n      // Calc the intersection coord between the point anf the last point outside the rect\n      const inter = intersection(boundryNode, lastPointOutside, point);\n      log.warn('abc88 inside', point, lastPointOutside, inter);\n      log.warn('abc88 intersection', inter);\n\n      // // Check case where the intersection is the same as the last point\n      let pointPresent = false;\n      points.forEach((p) => {\n        pointPresent = pointPresent || (p.x === inter.x && p.y === inter.y);\n      });\n      // // if (!pointPresent) {\n      if (!points.some((e) => e.x === inter.x && e.y === inter.y)) {\n        points.push(inter);\n      } else {\n        log.warn('abc88 no intersect', inter, points);\n      }\n      // points.push(inter);\n      isInside = true;\n    } else {\n      // Outside\n      log.warn('abc88 outside', point, lastPointOutside);\n      lastPointOutside = point;\n      // points.push(point);\n      if (!isInside) {\n        points.push(point);\n      }\n    }\n  });\n  log.warn('abc88 returning points', points);\n  return points;\n};\n\n//(edgePaths, e, edge, clusterDb, diagramtype, graph)\nexport const insertEdge = function (elem, e, edge, clusterDb, diagramType, graph) {\n  let points = edge.points;\n  let pointsHasChanged = false;\n  const tail = graph.node(e.v);\n  var head = graph.node(e.w);\n\n  log.info('abc88 InsertEdge: ', edge);\n  if (head.intersect && tail.intersect) {\n    points = points.slice(1, edge.points.length - 1);\n    points.unshift(tail.intersect(points[0]));\n    log.info(\n      'Last point',\n      points[points.length - 1],\n      head,\n      head.intersect(points[points.length - 1])\n    );\n    points.push(head.intersect(points[points.length - 1]));\n  }\n  if (edge.toCluster) {\n    log.info('to cluster abc88', clusterDb[edge.toCluster]);\n    points = cutPathAtIntersect(edge.points, clusterDb[edge.toCluster].node);\n    // log.trace('edge', edge);\n    // points = [];\n    // let lastPointOutside; // = edge.points[0];\n    // let isInside = false;\n    // edge.points.forEach(point => {\n    //   const node = clusterDb[edge.toCluster].node;\n    //   log.warn('checking from', edge.fromCluster, point, node);\n\n    //   if (!outsideNode(node, point) && !isInside) {\n    //     log.trace('inside', edge.toCluster, point, lastPointOutside);\n\n    //     // First point inside the rect\n    //     const inter = intersection(node, lastPointOutside, point);\n\n    //     let pointPresent = false;\n    //     points.forEach(p => {\n    //       pointPresent = pointPresent || (p.x === inter.x && p.y === inter.y);\n    //     });\n    //     // if (!pointPresent) {\n    //     if (!points.find(e => e.x === inter.x && e.y === inter.y)) {\n    //       points.push(inter);\n    //     } else {\n    //       log.warn('no intersect', inter, points);\n    //     }\n    //     isInside = true;\n    // } else {\n    //   // outside\n    //   lastPointOutside = point;\n    //   if (!isInside) points.push(point);\n    // }\n    // });\n    pointsHasChanged = true;\n  }\n\n  if (edge.fromCluster) {\n    log.info('from cluster abc88', clusterDb[edge.fromCluster]);\n    points = cutPathAtIntersect(points.reverse(), clusterDb[edge.fromCluster].node).reverse();\n\n    pointsHasChanged = true;\n  }\n\n  // The data for our line\n  const lineData = points.filter((p) => !Number.isNaN(p.y));\n\n  // This is the accessor function we talked about above\n  let curve;\n  // Currently only flowcharts get the curve from the settings, perhaps this should\n  // be expanded to a common setting? Restricting it for now in order not to cause side-effects that\n  // have not been thought through\n  if (diagramType === 'graph' || diagramType === 'flowchart') {\n    curve = edge.curve || curveBasis;\n  } else {\n    curve = curveBasis;\n  }\n  // curve = curveLinear;\n  const lineFunction = line()\n    .x(function (d) {\n      return d.x;\n    })\n    .y(function (d) {\n      return d.y;\n    })\n    .curve(curve);\n\n  // Construct stroke classes based on properties\n  let strokeClasses;\n  switch (edge.thickness) {\n    case 'normal':\n      strokeClasses = 'edge-thickness-normal';\n      break;\n    case 'thick':\n      strokeClasses = 'edge-thickness-thick';\n      break;\n    case 'invisible':\n      strokeClasses = 'edge-thickness-thick';\n      break;\n    default:\n      strokeClasses = '';\n  }\n  switch (edge.pattern) {\n    case 'solid':\n      strokeClasses += ' edge-pattern-solid';\n      break;\n    case 'dotted':\n      strokeClasses += ' edge-pattern-dotted';\n      break;\n    case 'dashed':\n      strokeClasses += ' edge-pattern-dashed';\n      break;\n  }\n\n  const svgPath = elem\n    .append('path')\n    .attr('d', lineFunction(lineData))\n    .attr('id', edge.id)\n    .attr('class', ' ' + strokeClasses + (edge.classes ? ' ' + edge.classes : ''))\n    .attr('style', edge.style);\n\n  // DEBUG code, adds a red circle at each edge coordinate\n  // edge.points.forEach((point) => {\n  //   elem\n  //     .append('circle')\n  //     .style('stroke', 'red')\n  //     .style('fill', 'red')\n  //     .attr('r', 1)\n  //     .attr('cx', point.x)\n  //     .attr('cy', point.y);\n  // });\n\n  let url = '';\n  // // TODO: Can we load this config only from the rendered graph type?\n  if (getConfig().flowchart.arrowMarkerAbsolute || getConfig().state.arrowMarkerAbsolute) {\n    url =\n      window.location.protocol +\n      '//' +\n      window.location.host +\n      window.location.pathname +\n      window.location.search;\n    url = url.replace(/\\(/g, '\\\\(');\n    url = url.replace(/\\)/g, '\\\\)');\n  }\n  log.info('arrowTypeStart', edge.arrowTypeStart);\n  log.info('arrowTypeEnd', edge.arrowTypeEnd);\n\n  switch (edge.arrowTypeStart) {\n    case 'arrow_cross':\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-crossStart' + ')');\n      break;\n    case 'arrow_point':\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-pointStart' + ')');\n      break;\n    case 'arrow_barb':\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-barbStart' + ')');\n      break;\n    case 'arrow_circle':\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-circleStart' + ')');\n      break;\n    case 'aggregation':\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-aggregationStart' + ')');\n      break;\n    case 'extension':\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-extensionStart' + ')');\n      break;\n    case 'composition':\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-compositionStart' + ')');\n      break;\n    case 'dependency':\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-dependencyStart' + ')');\n      break;\n    case 'lollipop':\n      svgPath.attr('marker-start', 'url(' + url + '#' + diagramType + '-lollipopStart' + ')');\n      break;\n    default:\n  }\n  switch (edge.arrowTypeEnd) {\n    case 'arrow_cross':\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-crossEnd' + ')');\n      break;\n    case 'arrow_point':\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-pointEnd' + ')');\n      break;\n    case 'arrow_barb':\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-barbEnd' + ')');\n      break;\n    case 'arrow_circle':\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-circleEnd' + ')');\n      break;\n    case 'aggregation':\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-aggregationEnd' + ')');\n      break;\n    case 'extension':\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-extensionEnd' + ')');\n      break;\n    case 'composition':\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-compositionEnd' + ')');\n      break;\n    case 'dependency':\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-dependencyEnd' + ')');\n      break;\n    case 'lollipop':\n      svgPath.attr('marker-end', 'url(' + url + '#' + diagramType + '-lollipopEnd' + ')');\n      break;\n    default:\n  }\n  let paths = {};\n  if (pointsHasChanged) {\n    paths.updatedPath = points;\n  }\n  paths.originalPath = edge.points;\n  return paths;\n};\n","import { line, curveBasis } from 'd3';\nimport utils from '../../utils';\nimport { log } from '../../logger';\nimport { parseGenericTypes } from '../common/common';\n\nlet edgeCount = 0;\nexport const drawEdge = function (elem, path, relation, conf, diagObj) {\n  const getRelationType = function (type) {\n    switch (type) {\n      case diagObj.db.relationType.AGGREGATION:\n        return 'aggregation';\n      case diagObj.db.relationType.EXTENSION:\n        return 'extension';\n      case diagObj.db.relationType.COMPOSITION:\n        return 'composition';\n      case diagObj.db.relationType.DEPENDENCY:\n        return 'dependency';\n      case diagObj.db.relationType.LOLLIPOP:\n        return 'lollipop';\n    }\n  };\n\n  path.points = path.points.filter((p) => !Number.isNaN(p.y));\n\n  // The data for our line\n  const lineData = path.points;\n\n  // This is the accessor function we talked about above\n  const lineFunction = line()\n    .x(function (d) {\n      return d.x;\n    })\n    .y(function (d) {\n      return d.y;\n    })\n    .curve(curveBasis);\n\n  const svgPath = elem\n    .append('path')\n    .attr('d', lineFunction(lineData))\n    .attr('id', 'edge' + edgeCount)\n    .attr('class', 'relation');\n  let url = '';\n  if (conf.arrowMarkerAbsolute) {\n    url =\n      window.location.protocol +\n      '//' +\n      window.location.host +\n      window.location.pathname +\n      window.location.search;\n    url = url.replace(/\\(/g, '\\\\(');\n    url = url.replace(/\\)/g, '\\\\)');\n  }\n\n  if (relation.relation.lineType == 1) {\n    svgPath.attr('class', 'relation dashed-line');\n  }\n  if (relation.relation.lineType == 10) {\n    svgPath.attr('class', 'relation dotted-line');\n  }\n  if (relation.relation.type1 !== 'none') {\n    svgPath.attr(\n      'marker-start',\n      'url(' + url + '#' + getRelationType(relation.relation.type1) + 'Start' + ')'\n    );\n  }\n  if (relation.relation.type2 !== 'none') {\n    svgPath.attr(\n      'marker-end',\n      'url(' + url + '#' + getRelationType(relation.relation.type2) + 'End' + ')'\n    );\n  }\n\n  let x, y;\n  const l = path.points.length;\n  // Calculate Label position\n  let labelPosition = utils.calcLabelPosition(path.points);\n  x = labelPosition.x;\n  y = labelPosition.y;\n\n  let p1_card_x, p1_card_y;\n  let p2_card_x, p2_card_y;\n\n  if (l % 2 !== 0 && l > 1) {\n    let cardinality_1_point = utils.calcCardinalityPosition(\n      relation.relation.type1 !== 'none',\n      path.points,\n      path.points[0]\n    );\n    let cardinality_2_point = utils.calcCardinalityPosition(\n      relation.relation.type2 !== 'none',\n      path.points,\n      path.points[l - 1]\n    );\n\n    log.debug('cardinality_1_point ' + JSON.stringify(cardinality_1_point));\n    log.debug('cardinality_2_point ' + JSON.stringify(cardinality_2_point));\n\n    p1_card_x = cardinality_1_point.x;\n    p1_card_y = cardinality_1_point.y;\n    p2_card_x = cardinality_2_point.x;\n    p2_card_y = cardinality_2_point.y;\n  }\n\n  if (relation.title !== undefined) {\n    const g = elem.append('g').attr('class', 'classLabel');\n    const label = g\n      .append('text')\n      .attr('class', 'label')\n      .attr('x', x)\n      .attr('y', y)\n      .attr('fill', 'red')\n      .attr('text-anchor', 'middle')\n      .text(relation.title);\n\n    window.label = label;\n    const bounds = label.node().getBBox();\n\n    g.insert('rect', ':first-child')\n      .attr('class', 'box')\n      .attr('x', bounds.x - conf.padding / 2)\n      .attr('y', bounds.y - conf.padding / 2)\n      .attr('width', bounds.width + conf.padding)\n      .attr('height', bounds.height + conf.padding);\n  }\n\n  log.info('Rendering relation ' + JSON.stringify(relation));\n  if (relation.relationTitle1 !== undefined && relation.relationTitle1 !== 'none') {\n    const g = elem.append('g').attr('class', 'cardinality');\n    g.append('text')\n      .attr('class', 'type1')\n      .attr('x', p1_card_x)\n      .attr('y', p1_card_y)\n      .attr('fill', 'black')\n      .attr('font-size', '6')\n      .text(relation.relationTitle1);\n  }\n  if (relation.relationTitle2 !== undefined && relation.relationTitle2 !== 'none') {\n    const g = elem.append('g').attr('class', 'cardinality');\n    g.append('text')\n      .attr('class', 'type2')\n      .attr('x', p2_card_x)\n      .attr('y', p2_card_y)\n      .attr('fill', 'black')\n      .attr('font-size', '6')\n      .text(relation.relationTitle2);\n  }\n\n  edgeCount++;\n};\n\n/**\n * Renders a class diagram\n *\n * @param {SVGSVGElement} elem The element to draw it into\n * @param classDef\n * @param conf\n * @param diagObj\n * @todo Add more information in the JSDOC here\n */\nexport const drawClass = function (elem, classDef, conf, diagObj) {\n  log.debug('Rendering class ', classDef, conf);\n\n  const id = classDef.id;\n  const classInfo = {\n    id: id,\n    label: classDef.id,\n    width: 0,\n    height: 0,\n  };\n\n  // add class group\n  const g = elem.append('g').attr('id', diagObj.db.lookUpDomId(id)).attr('class', 'classGroup');\n\n  // add title\n  let title;\n  if (classDef.link) {\n    title = g\n      .append('svg:a')\n      .attr('xlink:href', classDef.link)\n      .attr('target', classDef.linkTarget)\n      .append('text')\n      .attr('y', conf.textHeight + conf.padding)\n      .attr('x', 0);\n  } else {\n    title = g\n      .append('text')\n      .attr('y', conf.textHeight + conf.padding)\n      .attr('x', 0);\n  }\n\n  // add annotations\n  let isFirst = true;\n  classDef.annotations.forEach(function (member) {\n    const titleText2 = title.append('tspan').text('«' + member + '»');\n    if (!isFirst) {\n      titleText2.attr('dy', conf.textHeight);\n    }\n    isFirst = false;\n  });\n\n  let classTitleString = classDef.id;\n\n  if (classDef.type !== undefined && classDef.type !== '') {\n    classTitleString += '<' + classDef.type + '>';\n  }\n\n  const classTitle = title.append('tspan').text(classTitleString).attr('class', 'title');\n\n  // If class has annotations the title needs to have an offset of the text height\n  if (!isFirst) {\n    classTitle.attr('dy', conf.textHeight);\n  }\n\n  const titleHeight = title.node().getBBox().height;\n\n  const membersLine = g\n    .append('line') // text label for the x axis\n    .attr('x1', 0)\n    .attr('y1', conf.padding + titleHeight + conf.dividerMargin / 2)\n    .attr('y2', conf.padding + titleHeight + conf.dividerMargin / 2);\n\n  const members = g\n    .append('text') // text label for the x axis\n    .attr('x', conf.padding)\n    .attr('y', titleHeight + conf.dividerMargin + conf.textHeight)\n    .attr('fill', 'white')\n    .attr('class', 'classText');\n\n  isFirst = true;\n  classDef.members.forEach(function (member) {\n    addTspan(members, member, isFirst, conf);\n    isFirst = false;\n  });\n\n  const membersBox = members.node().getBBox();\n\n  const methodsLine = g\n    .append('line') // text label for the x axis\n    .attr('x1', 0)\n    .attr('y1', conf.padding + titleHeight + conf.dividerMargin + membersBox.height)\n    .attr('y2', conf.padding + titleHeight + conf.dividerMargin + membersBox.height);\n\n  const methods = g\n    .append('text') // text label for the x axis\n    .attr('x', conf.padding)\n    .attr('y', titleHeight + 2 * conf.dividerMargin + membersBox.height + conf.textHeight)\n    .attr('fill', 'white')\n    .attr('class', 'classText');\n\n  isFirst = true;\n\n  classDef.methods.forEach(function (method) {\n    addTspan(methods, method, isFirst, conf);\n    isFirst = false;\n  });\n\n  const classBox = g.node().getBBox();\n  var cssClassStr = ' ';\n\n  if (classDef.cssClasses.length > 0) {\n    cssClassStr = cssClassStr + classDef.cssClasses.join(' ');\n  }\n\n  const rect = g\n    .insert('rect', ':first-child')\n    .attr('x', 0)\n    .attr('y', 0)\n    .attr('width', classBox.width + 2 * conf.padding)\n    .attr('height', classBox.height + conf.padding + 0.5 * conf.dividerMargin)\n    .attr('class', cssClassStr);\n\n  const rectWidth = rect.node().getBBox().width;\n\n  // Center title\n  // We subtract the width of each text element from the class box width and divide it by 2\n  title.node().childNodes.forEach(function (x) {\n    x.setAttribute('x', (rectWidth - x.getBBox().width) / 2);\n  });\n\n  if (classDef.tooltip) {\n    title.insert('title').text(classDef.tooltip);\n  }\n\n  membersLine.attr('x2', rectWidth);\n  methodsLine.attr('x2', rectWidth);\n\n  classInfo.width = rectWidth;\n  classInfo.height = classBox.height + conf.padding + 0.5 * conf.dividerMargin;\n\n  return classInfo;\n};\n\n/**\n * Renders a note diagram\n *\n * @param {SVGSVGElement} elem The element to draw it into\n * @param {{id: string; text: string; class: string;}} note\n * @param conf\n * @param diagObj\n * @todo Add more information in the JSDOC here\n */\nexport const drawNote = function (elem, note, conf, diagObj) {\n  log.debug('Rendering note ', note, conf);\n\n  const id = note.id;\n  const noteInfo = {\n    id: id,\n    text: note.text,\n    width: 0,\n    height: 0,\n  };\n\n  // add class group\n  const g = elem.append('g').attr('id', id).attr('class', 'classGroup');\n\n  // add text\n  let text = g\n    .append('text')\n    .attr('y', conf.textHeight + conf.padding)\n    .attr('x', 0);\n\n  const lines = JSON.parse(`\"${note.text}\"`).split('\\n');\n\n  lines.forEach(function (line) {\n    log.debug(`Adding line: ${line}`);\n    text.append('tspan').text(line).attr('class', 'title').attr('dy', conf.textHeight);\n  });\n\n  const noteBox = g.node().getBBox();\n\n  const rect = g\n    .insert('rect', ':first-child')\n    .attr('x', 0)\n    .attr('y', 0)\n    .attr('width', noteBox.width + 2 * conf.padding)\n    .attr(\n      'height',\n      noteBox.height + lines.length * conf.textHeight + conf.padding + 0.5 * conf.dividerMargin\n    );\n\n  const rectWidth = rect.node().getBBox().width;\n\n  // Center title\n  // We subtract the width of each text element from the class box width and divide it by 2\n  text.node().childNodes.forEach(function (x) {\n    x.setAttribute('x', (rectWidth - x.getBBox().width) / 2);\n  });\n\n  noteInfo.width = rectWidth;\n  noteInfo.height =\n    noteBox.height + lines.length * conf.textHeight + conf.padding + 0.5 * conf.dividerMargin;\n\n  return noteInfo;\n};\n\nexport const parseMember = function (text) {\n  const fieldRegEx = /^([#+~-])?(\\w+)(~\\w+~|\\[])?\\s+(\\w+) *([$*])?$/;\n  const methodRegEx = /^([#+|~-])?(\\w+) *\\( *(.*)\\) *([$*])? *(\\w*[[\\]|~]*\\s*\\w*~?)$/;\n\n  let fieldMatch = text.match(fieldRegEx);\n  let methodMatch = text.match(methodRegEx);\n\n  if (fieldMatch && !methodMatch) {\n    return buildFieldDisplay(fieldMatch);\n  } else if (methodMatch) {\n    return buildMethodDisplay(methodMatch);\n  } else {\n    return buildLegacyDisplay(text);\n  }\n};\n\nconst buildFieldDisplay = function (parsedText) {\n  let cssStyle = '';\n  let displayText = '';\n\n  try {\n    let visibility = parsedText[1] ? parsedText[1].trim() : '';\n    let fieldType = parsedText[2] ? parsedText[2].trim() : '';\n    let genericType = parsedText[3] ? parseGenericTypes(parsedText[3].trim()) : '';\n    let fieldName = parsedText[4] ? parsedText[4].trim() : '';\n    let classifier = parsedText[5] ? parsedText[5].trim() : '';\n\n    displayText = visibility + fieldType + genericType + ' ' + fieldName;\n    cssStyle = parseClassifier(classifier);\n  } catch (err) {\n    displayText = parsedText;\n  }\n\n  return {\n    displayText: displayText,\n    cssStyle: cssStyle,\n  };\n};\n\nconst buildMethodDisplay = function (parsedText) {\n  let cssStyle = '';\n  let displayText = '';\n\n  try {\n    let visibility = parsedText[1] ? parsedText[1].trim() : '';\n    let methodName = parsedText[2] ? parsedText[2].trim() : '';\n    let parameters = parsedText[3] ? parseGenericTypes(parsedText[3].trim()) : '';\n    let classifier = parsedText[4] ? parsedText[4].trim() : '';\n    let returnType = parsedText[5] ? ' : ' + parseGenericTypes(parsedText[5]).trim() : '';\n\n    displayText = visibility + methodName + '(' + parameters + ')' + returnType;\n    cssStyle = parseClassifier(classifier);\n  } catch (err) {\n    displayText = parsedText;\n  }\n\n  return {\n    displayText: displayText,\n    cssStyle: cssStyle,\n  };\n};\n\nconst buildLegacyDisplay = function (text) {\n  // if for some reason we don't have any match, use old format to parse text\n  let displayText = '';\n  let cssStyle = '';\n  let returnType = '';\n  let methodStart = text.indexOf('(');\n  let methodEnd = text.indexOf(')');\n\n  if (methodStart > 1 && methodEnd > methodStart && methodEnd <= text.length) {\n    let visibility = '';\n    let methodName = '';\n\n    let firstChar = text.substring(0, 1);\n    if (firstChar.match(/\\w/)) {\n      methodName = text.substring(0, methodStart).trim();\n    } else {\n      if (firstChar.match(/[#+~-]/)) {\n        visibility = firstChar;\n      }\n\n      methodName = text.substring(1, methodStart).trim();\n    }\n\n    const parameters = text.substring(methodStart + 1, methodEnd);\n    const classifier = text.substring(methodEnd + 1, 1);\n    cssStyle = parseClassifier(text.substring(methodEnd + 1, methodEnd + 2));\n\n    displayText = visibility + methodName + '(' + parseGenericTypes(parameters.trim()) + ')';\n\n    if (methodEnd < text.length) {\n      returnType = text.substring(methodEnd + 2).trim();\n      if (returnType !== '') {\n        returnType = ' : ' + parseGenericTypes(returnType);\n        displayText += returnType;\n      }\n    }\n  } else {\n    // finally - if all else fails, just send the text back as written (other than parsing for generic types)\n    displayText = parseGenericTypes(text);\n  }\n\n  return {\n    displayText,\n    cssStyle,\n  };\n};\n/**\n * Adds a <tspan> for a member in a diagram\n *\n * @param {SVGElement} textEl The element to append to\n * @param {string} txt The member\n * @param {boolean} isFirst\n * @param {{ padding: string; textHeight: string }} conf The configuration for the member\n */\nconst addTspan = function (textEl, txt, isFirst, conf) {\n  let member = parseMember(txt);\n\n  const tSpan = textEl.append('tspan').attr('x', conf.padding).text(member.displayText);\n\n  if (member.cssStyle !== '') {\n    tSpan.attr('style', member.cssStyle);\n  }\n\n  if (!isFirst) {\n    tSpan.attr('dy', conf.textHeight);\n  }\n};\n\n/**\n * Gives the styles for a classifier\n *\n * @param {'+' | '-' | '#' | '~' | '*' | '$'} classifier The classifier string\n * @returns {string} Styling for the classifier\n */\nconst parseClassifier = function (classifier) {\n  switch (classifier) {\n    case '*':\n      return 'font-style:italic;';\n    case '$':\n      return 'text-decoration:underline;';\n    default:\n      return '';\n  }\n};\n\nexport default {\n  drawClass,\n  drawEdge,\n  drawNote,\n  parseMember,\n};\n"],"names":["insertMarkers","elem","markerArray","type","id","forEach","markerName","markers","extension","log","append","attr","composition","aggregation","dependency","lollipop","point","style","circle","cross","barb","applyStyle","dom","styleFn","addHtmlLabel","node","fo","select","document","createElementNS","div","label","labelClass","isNode","html","labelStyle","createLabel","_vertexText","isTitle","vertexText","evaluate","getConfig","flowchart","htmlLabels","replace","decodeEntities","s","vertexNode","svgLabel","setAttribute","rows","split","Array","isArray","row","tspan","setAttributeNS","textContent","trim","appendChild","labelHelper","parent","_classes","classes","useHtmlLabels","shapeSvg","insert","domId","labelText","textNode","text","labelType","createText","sanitizeText","width","wrappingWidth","bbox","getBBox","children","dv","getBoundingClientRect","height","halfPadding","padding","centerLabel","updateNodeBounds","element","insertPolygonShape","w","h","points","map","d","x","y","join","intersectNode","intersect","intersectEllipse","rx","ry","cx","cy","px","py","det","Math","sqrt","dx","abs","dy","intersectCircle","intersectLine","p1","p2","q1","q2","a1","a2","b1","b2","c1","c2","r1","r2","r3","r4","denom","offset","num","sameSign","intersectPolygon","polyPoints","x1","y1","intersections","minX","Number","POSITIVE_INFINITY","minY","entry","min","left","top","i","length","push","sort","p","q","pdx","pdy","distp","qdx","qdy","distq","intersectRect","sx","sy","ellipse","polygon","rect","note","question","questionElem","choice","hexagon","f","m","hex","rect_left_inv_arrow","el","lean_right","lean_left","trapezoid","inv_trapezoid","rect_right_inv_arrow","cylinder","shape","pos","totalWidth","totalHeight","props","propKeys","Set","Object","keys","borders","applyNodePropertyBorders","delete","propKey","labelRect","strokeDashArray","addBorder","skipBorder","includes","rectWithTitle","innerLine","text2","flat","title","textRows","slice","titleBox","descr","stadium","doublecircle","gap","circleGroup","outerCircle","innerCircle","subroutine","start","forkJoin","dir","end","class_box","rowPadding","lineHeight","topLine","bottomLine","maxWidth","maxHeight","labelContainer","verticalPos","hasInterface","classData","annotations","interfaceLabelText","interfaceLabel","interfaceBBox","classTitleString","classTitleLabel","classTitleBBox","classAttributes","members","str","parsedInfo","parseMember","parsedText","displayText","lbl","cssStyle","classMethods","methods","diffX","shapes","rhombus","fork","nodeElems","insertNode","newEl","link","target","securityLevel","linkTarget","tooltip","class","haveCallback","setNodeElem","clear","positionNode","diff","clusterNode","edgeLabels","terminalLabels","insertEdgeLabel","edge","labelElement","addSvgBackground","edgeLabel","startLabelLeft","startLabelElement","startEdgeLabelLeft","inner","slBox","startLeft","setTerminalWidth","startLabelRight","startEdgeLabelRight","startRight","endLabelLeft","endLabelElement","endEdgeLabelLeft","endLeft","endLabelRight","endEdgeLabelRight","endRight","value","positionEdgeLabel","paths","path","updatedPath","originalPath","utils","arrowTypeStart","arrowTypeEnd","outsideNode","intersection","outsidePoint","insidePoint","JSON","stringify","r","Q","R","res","_x","_y","cutPathAtIntersect","_points","boundryNode","lastPointOutside","isInside","inter","pointPresent","some","e","insertEdge","clusterDb","diagramType","graph","pointsHasChanged","tail","v","head","unshift","toCluster","fromCluster","reverse","lineData","filter","isNaN","curve","curveBasis","lineFunction","line","strokeClasses","thickness","pattern","svgPath","url","arrowMarkerAbsolute","state","window","location","protocol","host","pathname","search","edgeCount","drawEdge","relation","conf","diagObj","getRelationType","db","relationType","AGGREGATION","EXTENSION","COMPOSITION","DEPENDENCY","LOLLIPOP","lineType","type1","type2","l","p1_card_x","p1_card_y","p2_card_x","p2_card_y","labelPosition","cardinality_1_point","cardinality_2_point","g","bounds","relationTitle1","relationTitle2","drawClass","classDef","classInfo","lookUpDomId","textHeight","isFirst","member","titleText2","classTitle","titleHeight","membersLine","dividerMargin","addTspan","membersBox","methodsLine","method","classBox","cssClassStr","cssClasses","rectWidth","childNodes","drawNote","noteInfo","lines","parse","noteBox","fieldRegEx","methodRegEx","fieldMatch","match","methodMatch","buildFieldDisplay","buildMethodDisplay","buildLegacyDisplay","visibility","fieldType","genericType","parseGenericTypes","fieldName","classifier","parseClassifier","err","methodName","parameters","returnType","methodStart","indexOf","methodEnd","firstChar","substring","textEl","txt","tSpan","svgDraw"],"sourceRoot":""}